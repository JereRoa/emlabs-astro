---
import Layout from "../layouts/Layout.astro"
import { Picture, inferRemoteSize } from "astro:assets"
import { ServicesPageSchema } from '@/types'
const url = 'http://emlabs.local/wp-json/wp/v2/pages?slug=servicios'
const response = await fetch(url)
const json = await response.json()
const data = ServicesPageSchema.parse(json[0]) 

const serviceKeys = Array.from({length: 5}, (_, i)=>`service_${i+1}`)
---

<Layout
title={data.title.rendered}
subtitle={data.acf.subtitle}
bgImage={data.featured_images.full.url}
>
<div class="text-xl space-y-3 mt-10 lg:mt-0" set:html={data.content.rendered}></div>

<div class="mt-10 space-y-10">
    {serviceKeys.map( async (key) =>{

        const { title, description, image } = data.acf[key]
        const { width, height } = await inferRemoteSize(image)

        return(
            <section class="flex flex-col lg:flex-row lg:items-center gap-10">
                <div class="w-full lg:w-1/2">
                    <Picture 
                        src={image}
                        alt={`Imagen de ${data.title.rendered}`}
                        width={width}
                        height={height}
                    />
                </div>
                <div class="w-full lg:w-1/2">
                    <h3 class="text-blue-950 font-black text-4xl pb-10 uppercase">{title}</h3>
                    <p class="text-lg">{description}</p>
                </div>
            </section>

        )
    })}
</div>
</Layout>